Project Data Layer & Schema DocumentationVersion: 1.0Last Updated: Jan 20261. Overview: The Data BridgeThis document serves as the "Single Source of Truth" for the application's data layer. It resolves the critical differences between the flexible, loosely-typed Firestore Database (often populated via Excel/CSV uploads) and the strict, strongly-typed Flutter Application.The "Bridge" PatternAll data fetching logic must strictly adhere to the fromMap / fromFirestore factory constructors defined in the models. These constructors act as a bridge to safely parse:String numbers (e.g., "10" → 10)String booleans (e.g., "Yes" → true)Missing fields (Null safety & Fallbacks)2. Collection: questionsDescription: The master repository of all question content.Firestore Collection ID: questionsFirestore Field KeyFirestore TypeFlutter Model VariableFlutter TypeNotes & Data Rulesquestion_idStringcustomIdStringPrimary Business ID. (e.g., "17813"). Used for creating tests. Fallback: id (Document ID)SubjectStringsubjectStringDefault: "Physics" if missing. Case-sensitive.ChapterStringchapterStringSyllabus hierarchy level 1.TopicStringtopicStringSyllabus hierarchy level 2.Topic_L2StringtopicL2StringSyllabus hierarchy level 3 (Optional).Question typeStringtypeQuestionTypeEnum Mapped. Must match specific string values (see Enum Reference).image_urlStringimageUrlStringURL to the question image. Legacy keys supported: imageUrl, Imagesolution_urlStringsolutionUrlString?URL to the solution explanation image.Correct AnswerString / NumcorrectAnswerdynamicKept dynamic to handle "A" (String) or 5.4 (Num) or [1,2] (List).DifficultyStringdifficultyStringe.g., "Easy", "Medium", "Hard". Fallback: Difficulty_tagDifficulty_scoreNum / StringdifficultyScorenum?Safe Parse: Handle string-to-number conversion.PYQStringisPyqboolConversion: DB stores "Yes"/"No". App parses to true/false.PYQ_YearInt / StringpyqYearint?Safe Parse: Handle string-to-int conversion.Question No.Int / StringquestionNointSafe Parse: Handle string-to-int conversion.QC_StatusStringqcStatusString?Workflow status: "Pending QC", "Accepted", "Rejected".OCR_TextStringocrTextString?Raw text content extracted from the image.3. Collection: attemptsDescription: Records of a student taking a specific test or assignment.Firestore Collection ID: attemptsFirestore Field KeyFirestore TypeFlutter Model VariableFlutter TypeNotes & Data RulesuserIdStringuserIdStringFirebase Auth UID of the student.sourceIdStringsourceIdStringID of the Test config or Curation document.assignmentCodeStringassignmentCodeString6-char unique code (e.g., "X7K9P2").titleStringtitleStringSnapshot of test title at the time of attempt.modeStringmodeString"Test" (Timer down) or "Practice" (Instant feedback).onlySingleAttemptBooleanonlySingleAttemptboolStrict mode flag. Default: false.startedAtTimestampstartedAtTimestampServer timestamp.completedAtTimestampcompletedAtTimestampServer timestamp (for history sorting).scoreNumberscorenumCalculated score (+4/-1 logic).timeTakenSecondsNumbertimeTakenSecondsintTotal duration.responsesMapresponsesMapKey: questionId (String). Value: ResponseObject.The Response Object (Nested in responses map)Key = Question ID stringMap KeyTypeDescriptionstatusStringEnum string: "CORRECT", "INCORRECT", "SKIPPED", "REVIEW".selectedOptionDynamicThe user's input (String "A" or Number).timeSpentNumberSeconds spent specifically on this question.visitCountNumberHow many times the user opened this question.smartTimeAnalysisStringTag: "Perfect Attempt", "Overtime", "Rushed", etc.4. Collection: questions_curationDescription: Assignments or Tests created by Teachers (or System generated).Firestore Collection ID: questions_curationFirestore Field KeyFirestore TypeFlutter Model VariableFlutter TypeNotes & Data RulesassignmentCodeStringassignmentCodeStringUnique Lookup Key. 6-char alphanumeric.titleStringtitleStringTitle shown to students.questionIdsList<String>questionIdsList<String>List of question_id (Business IDs, NOT doc IDs).studentIdNumberstudentIdintTargeting: Specific numeric Student ID (e.g., 2026).teacherUidStringteacherUidStringUID of the creator.deadlineTimestampdeadlineTimestamp?Optional expiry date.timeLimitMinutesNumbertimeLimitMinutesint?Optional duration override.onlySingleAttemptBooleanonlySingleAttemptboolIf true, test disappears after submission.statusString--"Assigned" or "Submitted".5. Collection: usersDescription: User profiles for authentication and role management.Firestore Collection ID: usersFirestore Field KeyFirestore TypeFlutter Model VariableFlutter TypeNotes & Data RulesuidStringuidStringMatches Firebase Auth UID.roleStringroleString"student" or "teacher".studentIdNumberstudentIdintUnique Integer ID for students (e.g., 101).assignmentCodesSubmittedList<String>assignmentCodesSubmittedListTracks completed assignments to prevent re-attempts.onboardingCompletedBooleanonboardingCompletedbool6. Enum Reference (test_enums.dart)Question Types (QuestionType)Ensure the Firestore string matches the 'String Value' column exactly.Dart Enum ValueFirestore String ValueDescriptionQuestionType.singleCorrect"Single Correct"Standard MCQ.QuestionType.numerical"Numerical type"Integer or Decimal answer.QuestionType.multipleCorrect"One or more options correct"Multiple checkboxes.QuestionType.matrixSingle"Single Matrix Match"Match the following (1-to-1).QuestionType.matrixMulti"Multi Matrix Match"Match the following (N-to-N).QuestionType.unknownDefault FallbackUsed if parsing fails.7. Standardization Rules for DevelopersDates:Firestore: Always use Timestamp (not String).Flutter: Convert using (data['field'] as Timestamp).toDate().Safe Parsing Pattern:Never assume a number field in Firestore is actually a number. It might be a String due to CSV imports.Correct Code:DartquestionNo: data['Question No.'] is int
    ? data['Question No.']
    : int.tryParse(data['Question No.']?.toString() ?? '0') ?? 0;
IDs:User UID: Long alphanumeric string (Auth).Student ID: Short integer (e.g., 2024).Question ID: Business Logic ID (e.g., "1055"). Do NOT use the Firestore Document ID for linking questions to tests.